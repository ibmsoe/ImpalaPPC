====
---- QUERY
use tpch_nested_parquet
====
---- QUERY
select count(*)
from tpch_nested_parquet.customer c, c.c_orders o, o.o_lineitems i
where c_custkey in (1, 2) and o_orderkey in (4808192, 1374019)
---- RESULTS
7
---- TYPES
bigint
====
---- QUERY
select count(*)
from tpch_nested_parquet.customer c, c.c_orders o, o.o_lineitems i
---- RESULTS
6001215
---- TYPES
bigint
====
---- QUERY
select count(l_linenumber)
from tpch_nested_parquet.customer.c_orders.o_lineitems i
---- RESULTS
6001215
---- TYPES
bigint
====
---- QUERY
select count(*)
from tpch_nested_parquet.customer.c_orders.o_lineitems i
---- RESULTS
6001215
---- TYPES
bigint
====
---- QUERY
# Relational version of above queries (same results)
select count(l_linenumber) from tpch_parquet.lineitem
---- RESULTS
6001215
---- TYPES
bigint
====
---- QUERY
# Relational version (almost) of above query
select c_custkey, count(*)
from tpch_parquet.customer join tpch_parquet.orders on c_custkey = o_custkey
where c_custkey < 10
group by c_custkey
order by c_custkey
---- RESULTS
1,6
2,7
4,20
5,4
7,16
8,13
---- TYPES
bigint,bigint
====
---- QUERY
select c_custkey from tpch_nested_parquet.customer c left anti join c.c_orders
where c_custkey < 10 order by c_custkey
---- RESULTS
3
6
9
---- TYPES
bigint
====
---- QUERY
# Exercise TOP-N node with array data
select c_custkey, c_name, o_orderkey, o_orderpriority
from tpch_nested_parquet.customer c, c.c_orders o
where c_custkey < 100
order by o_orderpriority, o_orderkey
limit 10;
---- RESULTS
29,'Customer#000000029',24322,'1-URGENT'
46,'Customer#000000046',74055,'1-URGENT'
76,'Customer#000000076',309891,'1-URGENT'
53,'Customer#000000053',322501,'1-URGENT'
25,'Customer#000000025',330404,'1-URGENT'
22,'Customer#000000022',346693,'1-URGENT'
20,'Customer#000000020',360067,'1-URGENT'
79,'Customer#000000079',400101,'1-URGENT'
79,'Customer#000000079',410595,'1-URGENT'
65,'Customer#000000065',438881,'1-URGENT'
---- TYPES
bigint,string,bigint,string
====
---- QUERY
# IMPALA-2335: non-nullable zero-width tuples can be NULL. This query hit a DCHECK.
# In this query no slots of the supplier.s_partssupps array are materialized, so there
# are NULL tuples once the array is unnested.
SELECT t2.s_name
FROM tpch_nested_parquet.customer t1
INNER JOIN tpch_nested_parquet.supplier t2
  ON t2.s_phone = t1.c_phone AND t2.s_acctbal = t1.c_acctbal,
t2.s_partsupps t3
WHERE t2.s_suppkey > t2.s_nationkey;
---- RESULTS
---- TYPES
string
====
