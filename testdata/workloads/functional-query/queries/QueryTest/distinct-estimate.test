# These computations take a while so we do not want to add too many test cases
# They also require a non-trivial amount of data to get reasonable results.
====
---- QUERY
select count(distinct id), distinctpc(id), distinctpcsa(id) from alltypesagg
---- TYPES
bigint, bigint, bigint
---- RESULTS
10000,5295,9401
====
---- QUERY
# Test the distinctpcsa aggregate function on all col types with group by
select
  tinyint_col,
  distinctpcsa(id),
  distinctpcsa(bool_col),
  distinctpcsa(smallint_col),
  distinctpcsa(int_col),
  distinctpcsa(bigint_col),
  distinctpcsa(float_col),
  distinctpcsa(double_col),
  distinctpcsa(string_col),
  distinctpcsa(timestamp_col)
from alltypesagg
group by tinyint_col
---- TYPES
tinyint, bigint, bigint, bigint, bigint, bigint, bigint, bigint, bigint, bigint
---- RESULTS
2,965,0,19,103,103,99,110,99,1136
7,945,2,12,101,118,97,110,125,1030
8,1065,0,9,103,95,103,110,95,1019
NULL,1042,0,9,97,95,107,95,110,924
5,987,2,14,118,90,86,125,110,924
3,712,2,14,114,120,101,120,107,955
6,955,0,9,116,107,105,112,101,829
9,934,2,7,112,131,93,97,103,965
4,934,0,16,97,99,82,95,116,934
1,987,2,14,107,99,120,101,88,1019
====
---- QUERY
# Test the distinctpcsa aggregate function on all col types without group by
select
  distinctpcsa(id),
  distinctpcsa(bool_col),
  distinctpcsa(tinyint_col),
  distinctpcsa(smallint_col),
  distinctpcsa(int_col),
  distinctpcsa(bigint_col),
  distinctpcsa(float_col),
  distinctpcsa(double_col),
  distinctpcsa(string_col),
  distinctpcsa(timestamp_col)
from alltypesagg
---- TYPES
bigint, bigint, bigint, bigint, bigint, bigint, bigint, bigint, bigint, bigint
---- RESULTS
9401,2,14,95,1187,1008,1149,1019,965,9401
====
---- QUERY
# Test the distinctpc aggregate function on all col types with group by
select
  tinyint_col,
  distinctpc(id),
  distinctpc(bool_col),
  distinctpc(smallint_col),
  distinctpc(int_col),
  distinctpc(bigint_col),
  distinctpc(float_col),
  distinctpc(double_col),
  distinctpc(string_col),
  distinctpc(timestamp_col)
from alltypesagg
group by tinyint_col
---- TYPES
tinyint, bigint, bigint, bigint, bigint, bigint, bigint, bigint, bigint, bigint
---- RESULTS
1,1101,0,10,161,98,98,102,75,977
2,1137,0,12,123,123,108,95,155,1031
3,1137,0,12,123,98,82,97,78,1227
4,1227,0,10,155,112,107,90,113,956
5,1227,0,10,155,102,97,100,97,1113
6,1200,0,9,123,88,96,81,89,1054
7,1200,0,9,123,102,109,96,98,946
8,1309,0,10,150,97,102,106,100,936
9,1309,0,10,150,105,101,96,108,1113
NULL,1101,0,8,156,99,95,80,131,1009
====
---- QUERY
# Test the distinctpc aggregate function on all col types without group by
select
  distinctpc(id),
  distinctpc(bool_col),
  distinctpc(tinyint_col),
  distinctpc(smallint_col),
  distinctpc(int_col),
  distinctpc(bigint_col),
  distinctpc(float_col),
  distinctpc(double_col),
  distinctpc(string_col),
  distinctpc(timestamp_col)
from alltypesagg
---- TYPES
bigint, bigint, bigint, bigint, bigint, bigint, bigint, bigint, bigint, bigint
---- RESULTS
5295,1,14,163,661,1077,998,956,822,8166
====
---- QUERY
# Test the hll aggregate function on all col types without group by
select
  ndv(id),
  ndv(bool_col),
  ndv(tinyint_col),
  ndv(smallint_col),
  ndv(int_col),
  ndv(bigint_col),
  ndv(float_col),
  ndv(double_col),
  ndv(string_col),
  ndv(timestamp_col)
from alltypesagg
---- TYPES
bigint, bigint, bigint, bigint, bigint, bigint, bigint, bigint, bigint, bigint
---- RESULTS
10280,2,9,97,957,1008,1016,1005,963,10210
====
---- QUERY
# Test the distinctpc aggregate function on empty table
select distinctpc(field) from EmptyTable
---- TYPES
bigint
---- RESULTS
0
====
---- QUERY
# Test the hll aggregate function on empty table
select ndv(field) from EmptyTable
---- TYPES
bigint
---- RESULTS
0
====
