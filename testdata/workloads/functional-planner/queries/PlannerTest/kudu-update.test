---- QUERY
update functional_kudu.testtbl set name = 'peter' where zip > 94549
---- PLAN
UPDATE KUDU [functional_kudu.testtbl]
|
00:SCAN KUDU [functional_kudu.testtbl]
  predicates: zip > 94549
---- DISTRIBUTEDPLAN
UPDATE KUDU [functional_kudu.testtbl]
|
00:SCAN KUDU [functional_kudu.testtbl]
  predicates: zip > 94549
====
---- QUERY
# Predicate on key
update functional_kudu.testtbl set name = 'peter' where zip > 94549 and id = 5
---- PLAN
UPDATE KUDU [functional_kudu.testtbl]
|
00:SCAN KUDU [functional_kudu.testtbl]
  predicates: zip > 94549
  kudu predicates: id = 5
---- DISTRIBUTEDPLAN
UPDATE KUDU [functional_kudu.testtbl]
|
00:SCAN KUDU [functional_kudu.testtbl]
  predicates: zip > 94549
  kudu predicates: id = 5
====
---- QUERY
# Mixing predicate and value assignment
update functional_kudu.testtbl set zip = 94546 where zip > 94549
---- PLAN
UPDATE KUDU [functional_kudu.testtbl]
|
00:SCAN KUDU [functional_kudu.testtbl]
  predicates: zip > 94549
---- DISTRIBUTEDPLAN
UPDATE KUDU [functional_kudu.testtbl]
|
00:SCAN KUDU [functional_kudu.testtbl]
  predicates: zip > 94549
====
---- QUERY
update a
set a.name = b.name
from functional_kudu.testtbl a join functional.testtbl b on a.id = b.id
where a.id = 10
---- PLAN
UPDATE KUDU [functional_kudu.testtbl]
|
02:HASH JOIN [INNER JOIN]
|  hash predicates: a.id = b.id
|
|--01:SCAN HDFS [functional.testtbl b]
|     partitions=1/1 files=0 size=0B
|     predicates: b.id = 10
|
00:SCAN KUDU [functional_kudu.testtbla]
   kudu predicates: a.id = 10
---- DISTRIBUTEDPLAN
UPDATE KUDU [functional_kudu.testtbl]
|
02:HASH JOIN [INNER JOIN, BROADCAST]
|  hash predicates: a.id = b.id
|
|--03:EXCHANGE [BROADCAST]
|  |
|  01:SCAN HDFS [functional.testtbl b]
|     partitions=1/1 files=0 size=0B
|     predicates: b.id = 10
|
00:SCAN KUDU [functional_kudu.testtbla]
   kudu predicates: a.id = 10
====
---- QUERY
update a
set a.name = 'values'
from functional_kudu.testtbl a join (values(1 as ids, 2, 3) ) b on a.id = b.ids
---- PLAN
UPDATE KUDU [functional_kudu.testtbl]
|
02:HASH JOIN [INNER JOIN]
|  hash predicates: ids = a.id
|
|--00:SCAN KUDU [functional_kudu.testtbla]
|
01:UNION
   constant-operands=1
---- DISTRIBUTEDPLAN
UPDATE KUDU [functional_kudu.testtbl]
|
02:HASH JOIN [INNER JOIN, BROADCAST]
|  hash predicates: ids = a.id
|
|--03:EXCHANGE [UNPARTITIONED]
|  |
|  00:SCAN KUDU [functional_kudu.testtbla]
|
01:UNION
   constant-operands=1
====
---- QUERY
update a
set a.name = 'values'
from functional_kudu.testtbl a
where a.zip in (select zip from functional.testtbl limit 10)
---- PLAN
UPDATE KUDU [functional_kudu.testtbl]
|
02:HASH JOIN [LEFT SEMI JOIN]
|  hash predicates: a.zip = zip
|
|--01:SCAN HDFS [functional.testtbl]
|     partitions=1/1 files=0 size=0B
|     limit: 10
|
00:SCAN KUDU [functional_kudu.testtbla]
---- DISTRIBUTEDPLAN
UPDATE KUDU [functional_kudu.testtbl]
|
02:HASH JOIN [LEFT SEMI JOIN, BROADCAST]
|  hash predicates: a.zip = zip
|
|--04:EXCHANGE [BROADCAST]
|  |
|  03:EXCHANGE [UNPARTITIONED]
|  |  limit: 10
|  |
|  01:SCAN HDFS [functional.testtbl]
|     partitions=1/1 files=0 size=0B
|     limit: 10
|
00:SCAN KUDU [functional_kudu.testtbla]
====
---- QUERY
update functional_kudu.testtbl set zip = 94546 where false
---- PLAN
UPDATE KUDU [functional_kudu.testtbl]
|
00:EMPTYSET
---- DISTRIBUTEDPLAN
UPDATE KUDU [functional_kudu.testtbl]
|
00:EMPTYSET
====